## 关于URL编码

> 一般来说，URL只能使用英文字母、阿拉伯数字和某些标点符号，不能使用其他文字和符号。
>
> [RFC 1738](http://www.ietf.org/rfc/rfc1738.txt)硬性规定：
>
> "只有字母和数字[0-9a-zA-Z]、一些特殊符号"$-_.+!*'(),"[不包括双引号]、以及某些保留字，才可以不经过编码直接用于URL。"

这意味着，如果URL中有汉字，就必须编码后使用。RFC-1738没有规定具体的编码方法，而是交给应用程序（浏览器）自己决定。



### 结论一：网址路径编码，用的是`utf-8`编码。



### 查询query —> `?xx=xxx`不属于网址路径，其采用gb2312编码，但在每个字节前加上了%。结论二：查询字符串的编码，用的是操作系统的默认编码



### 结论三：GET和POST方法用的是网页编码。网页的编码取决于`<meta charset=”utf-8“ />`声明。



### Ajax调用的URL如果包含汉字，IE总是采用GB2312编码（操作系统的默认编码），Firefox总是采用utf-8编码。





### window.escape

想保证客户端用一种编码方法向服务器发送请求，使用Javascript先对URL编码，然后再向服务器提交。保证了服务器得到的数据时格式统一的。

`escape()`不能直接用于URL编码，它的真正作用是返回一个字符的Unicode编码值。

具体规则：除了ASCII字母、数字、标点符号"@ * _ + - . /"以外，对其他所有字符进行编码。在\u0000到\u00ff之间的符号被转成%xx的形式，其余符号被转成%uxxxx的形式。对应的解码函数式unescape()。

所以，"Hello World"的`escape()`编码就是"Hello%20World"。因为空格的Unicode值是20（十六进制）。

> 注：无论网页的原始编码是什么，一旦被Javascript编码，就都变为unicode字符。也就是说，Javascript函数的输入和输出，默认都是Unicode字符。

其次，`escape()`不对“+”编码。但是，网页在提交表单的时候，如果有空格，则会被转化为+字符。服务器处理数据的时候，会把+号处理成空格。



### window.encodeURI()

`encodeURI()`是Javascript 中真正用来对URL编码的函数。它着眼于对整个URL进行编码，因此除了唱啊金的符号以外，对其他一些这在网址中有特殊含义的符号"; / ? : @ & = + $ , #"，也不进行编码。它输出符号是utf-8形式，并且在每个字节前加%。



### window.encodeURIComponent()

最后一个Javascript编码函数是encodeURIComponent()。与encodeURI()的区别是，它用于对URL的组成部分进行个别编码，而不用于对整个URL进行编码。

因此，"; / ? : @ & = + $ , #"，这些在encodeURI()中不被编码的符号，在encodeURIComponent()中统统会被编码。至于具体的编码方法，两者是一样。



### 字符编码

#### 1. ASCII码

我们知道，在计算机内部，所有的信息最终都表示为一个二进制的字符串。每一个二进制位（bit）有0和1两种状态，因此八个二进制位就可以组合出256种状态，这被称为一个字节（byte）。也就是说，一个字节一共可以用来表示256种不同的状态，每一个状态对应一个符号，就是256个符号，从0000000到11111111。

上个世纪60年代，美国制定了一套字符编码，对英语字符与二进制位之间的关系，做了统一规定。这被称为ASCII码，一直沿用至今。



#### 2. 非ASCII编码

英语用128个符号编码就够了，表示其他语言时，显然128个符号是不够。所以需要更多的符号支持。比如汉字，汉字多达10w左右，一个字节只能表示256种符号，肯定是不够的，简体中文常见的编码方式是GB2312，使用两个字节表示一个汉字，所以理论上最多可以表示256x256个符号。



#### 3. Unicode

如果有一种编码，将世界上所有的符号都纳入其中。每一个符号都给予一个独一无二的编码，那么乱码问题就会消失。这就是Unicode，就像它的名字都表示的，这是一种所有符号的编码。



需要注意的是，Unicode只是一个符号集，它只规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。



#### 4. UTF-8

> **重复一遍，这里的关系是，UTF-8是Unicode的实现方式之一。**

UTF-8最大的一个特点，就是它是一种变长的编码方式。它可以使用1~4个字节表示一个符号，根据不同的符号而变化字节长度。  





[关于URL编码](http://www.ruanyifeng.com/blog/2010/02/url_encoding.html)

[字符编码笔记：ASCII，Unicode和UTF-8](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)